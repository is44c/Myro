<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<link rel="Stylesheet" type="text/css" href="../../../Common/StyleSheets/ie4.css">
<title>Lego NXT Configuration File</title>

</head>

<body>

<h1 class="Section1"><a name="_Toc140299171"></a><a name="_Toc140307948"></a>
Lego NXT Readme</h1>

<ul>
  <li><span class=MsoHyperlink><a href="#_Toc140307948">Lego NXT 
readme</a></span></li>
  <li><span class=MsoHyperlink><a href="#_Toc140307949">Overview</a></span></li>
  <li><span class=MsoHyperlink><a href="#_Toc140307950">Installing 
NXT Native Program</a></span></li>
  <li><span class=MsoHyperlink><a href="#_Toc140307951">Configuring 
Sensors</a></span></li>
  <li><span class=MsoHyperlink><a href="#_Toc140307952">Connecting 
NXT to Microsoft Robotics Studio</a></span></li>
  <li><span class=MsoHyperlink><a
href="readme.htm#trouble">Troubleshooting</a></span></li>
  <li><span class=MsoHyperlink><a href="#_Toc140307953">Appendix – 
Configuration File Documentation</a></span></li>
</ul>

<h3 class="Section1"><a name="_Toc140307949">Overview</a></h3>

<p>For Microsoft Robotics Studio to 
receive spontaneous sensor messages from the NXT there must be a program running 
on the NXT brick that monitors all sensors and spawns a message to the PC when a 
sensor’s value has changed.&nbsp; We will call this the NXT ‘msrs’ program, 
which is provided for you in both pre-compiled and visual language form.&nbsp; 
Follow the directions in the next section (<u><a
href="#_Toc140299173">Installing NXT Native Program<span style='display:none'>&nbsp;&nbsp; 
1</span></a></u>) for instructions on downloading it to the brick.</p>

<p>Because the sensors on the NXT can 
be configured in a number of ways, NXT main program must be provided with this 
configuration information.&nbsp; Therefore, a small configuration file can be 
sent to the brick when the NXT service is started.&nbsp; Read the <span
class=MsoHyperlink><a href="#_Toc140300559">Configuring Sensors<span
style='color:windowtext;display:none;text-decoration:none'>&nbsp; 1</span></a></span>
section for further info.</p>

<p>The Lego NXT firmware requires that 
one party be a master and the other a slave. &nbsp;&nbsp;This master is determined by 
whoever initiates the Bluetooth link.&nbsp; Follow the directions in the 
section: <u><a href="#_Toc140299174">Connecting NXT to Microsoft Robotics Studio<span style='display:none'>&nbsp; 
1</span></a></u> to learn how to connect to your NXT.&nbsp; This procedure has 
changed since the last CTP.</p>

<h3 class="Section1"><a name="_Toc140299173"></a><a name="_Toc140307950"></a>
Installing NXT ‘msrs’ Program</h3>

<p>The NXT ‘msrs’ program is a program 
written in the NXT visual language and runs natively on the brick.&nbsp; It 
monitors the sensors and sends messages back to the PC when something has 
changed.&nbsp; The executable version of this program will be downloaded 
automatically to the brick when you run the LegoNxt service.&nbsp;
    </p>
    <p>
        The source for this program is available in the MSRS samples at 
        Samples\Platforms\LEGO\NXT\Resources\MSRS006.rbt.&nbsp; The other files 
        are all “My Block” subroutines except msrs.rbt.&nbsp;They are provided 
        as reference, and for advanced users.&nbsp;They will need to be 
        modified in case you want to add more sensor types.</p>
    <div class=Section1>

<ul>
 <li>msrs.rbt </li>
    <li>Read3.rbt </li>
 <li>MOD.rbt</li>
 <li>GtrThan=.rbt</li>
 <li>LessThan=.rbt</li>
 <li>SendMsg.rbt</li>
 <li>DualThresh.rbt</li>
 <li>Process.rbt</li>
</ul>
    </div>

<h3><a name="_Toc140307951">Configuring Sensors</a></h3>

<p>The NXT provides a number of 
different sensor types and ways to read the sensors. Microsoft Robotics Studio 
supports these sensor types with the NXT:</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=657
 style='width:492.45pt;margin-left:-13.8pt;border-collapse:collapse'>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;background:
  black;padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Name</span></b></p>
  </td>
  <td width=218 style='width:163.25pt;border:solid black 1.0pt;border-left:
  none;background:black;padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Description</span></b></p>
  </td>
  <td width=160 style='width:120.35pt;border:solid black 1.0pt;border-left:
  none;background:black;padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Available Range</span></b></p>
  </td>
  <td width=204 style='width:152.85pt;border:solid black 1.0pt;border-left:
  none;background:black;padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Available Ports</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;border-top:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p>Touch</p>
  </td>
  <td width=218 style='width:163.25pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Binary touch sensor</p>
  </td>
  <td width=160 style='width:120.35pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-1</p>
  </td>
  <td width=204 style='width:152.85pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
 </tr>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;border-top:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sonar</p>
  </td>
  <td width=218 style='width:163.25pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Ultrasonic range sensor</p>
  </td>
  <td width=160 style='width:120.35pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-250</p>
  </td>
  <td width=204 style='width:152.85pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
 </tr>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;border-top:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sound</p>
  </td>
  <td width=218 style='width:163.25pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sound sensor</p>
  </td>
  <td width=160 style='width:120.35pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-100</p>
  </td>
  <td width=204 style='width:152.85pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
 </tr>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;border-top:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p>LightOn</p>
  </td>
  <td width=218 style='width:163.25pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Light sensor with red LED on</p>
  </td>
  <td width=160 style='width:120.35pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-100</p>
  </td>
  <td width=204 style='width:152.85pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
 </tr>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;border-top:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p>LightOff</p>
  </td>
  <td width=218 style='width:163.25pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Light sensor with red LED off</p>
  </td>
  <td width=160 style='width:120.35pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-100</p>
  </td>
  <td width=204 style='width:152.85pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
 </tr>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;border-top:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p>Angle</p>
  </td>
  <td width=218 style='width:163.25pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Motor shaft angle</p>
  </td>
  <td width=160 style='width:120.35pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>-2147483647 to <br>
  +2147483647</p>
  </td>
  <td width=204 style='width:152.85pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Motor 1, 2, 3</p>
  </td>
 </tr>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;border-top:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p>Encoder</p>
  </td>
  <td width=218 style='width:163.25pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sampled down motor angle</p>
  </td>
  <td width=160 style='width:120.35pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>User specified. 2-360</p>
  </td>
  <td width=204 style='width:152.85pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Motor 1, 2, 3</p>
  </td>
 </tr>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;border-top:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p>Button</p>
  </td>
  <td width=218 style='width:163.25pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>NXT control buttons</p>
  </td>
  <td width=160 style='width:120.35pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-1</p>
  </td>
  <td width=204 style='width:152.85pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Right, Left, and Enter Buttons</p>
  </td>
 </tr>
 <tr>
  <td width=75 style='width:56.0pt;border:solid windowtext 1.0pt;border-top:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p>Null</p>
  </td>
  <td width=218 style='width:163.25pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>No sensor connected</p>
  </td>
  <td width=160 style='width:120.35pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>N/A</p>
  </td>
  <td width=204 style='width:152.85pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>All</p>
  </td>
 </tr>
</table>

</div>

<p>In addition to specifying what type 
of sensor is on which port, the configuration file can also specify a specific 
range of sensor values to monitor or ignore.&nbsp; You can specify either an 
internal or external range.&nbsp; <u>All thresholds are inclusive</u>.&nbsp; 
Typically, you will want to be notified of the sensor’s entire range.&nbsp; This 
is easily done by setting the thresholds equal.&nbsp; In the figures below, only 
the thick red region will be monitored for sensor changes.</p>

<p><b>Internal range:</b></p>

<p align="center"><b><img border=0 width=353 height=57
src="readme_files/image002.jpg"></b></p>

<p><b>External range:</b></p>

<p align="center"><b><img border=0 width=353 height=56
src="readme_files/image003.jpg"></b></p>

<p><b>&nbsp;</b>&nbsp;</p>

<p><b>All: </b>(when thresholds are equal)</p>

<p align="center"><b><img border=0 width=350 height=60
src="readme_files/image004.jpg"></b></p>

<p>The NXT motors can be configured to 
be one of two sensor types, an angle sensor or an encoder.&nbsp; (Of course the 
‘null’ type is also available).&nbsp; When the motor is configured as an angle 
sensor, a target range is provided just like any other sensor.&nbsp; The motor’s 
angle will not reset when it is past 360 degrees.&nbsp; Note the high range of 
available output angle (-2147483647 to +2147483647).&nbsp; When the motor is 
configured to be an encoder, you only need to set its resolution (ticks per 
revolution).&nbsp; This value can be set anywhere from 2 to 360.&nbsp; It is 
best to use a value that divides evenly into 360.&nbsp; Note that at full speed, 
the NXT may not register some encoder increments if this value is set too high.&nbsp; 
We have found six (6) ticks per revolution to be a good value.</p>

<p>This sensor configuration may be set 
in many ways.&nbsp; The easiest method is through Internet Explorer.&nbsp; When 
you start the LegoNxtBrickService (or one that partners with it), for the first 
time, IE will open to the LegoNxtBrickService’s state page which has a nice web 
form for setting the COM port and sensor configuration.&nbsp; The next section (<span class=MsoHyperlink><a href="#_Toc140307952">Connecting 
NXT to Microsoft Robotics Studio<span style='color:windowtext;display:none;text-decoration:
none'>. 3</span></a></span>) covers this method in more detail.&nbsp; You can 
also set the configuration with a manifest or programmatically with a Configure 
message.</p>

<p><b><span style='color:red'>
Important:</span></b>
The LegoNxtBrickService does not send the configuration file to the brick every 
time the service starts. &nbsp;If, at startup, the COM port specified is 0, the 
service will wait until you fill out the form on the LegoNxtBrickService’s state 
page, or you send a Replace message.&nbsp; If you start the service with a 
manifest and configuration file with a valid COM port (as in Tutorials 3 and 4), 
the configuration file is assumed to already be on the brick and is not sent 
again.&nbsp; You can force a re-send of the configuration file to the NXT by 
simply going to the LegoNxtBrickService’s state page in IE and re-connecting 
with the new configuration.&nbsp; The service will automatically re-initialize 
the NXT, but in some cases the NXT and service will have to be restarted.</p>

<p>For advanced users: if you plan on 
modifying the native NXT program, and want further documentation on this 
configuration file, please see <span class=MsoHyperlink><a href="#_Toc140307953">
Appendix A - Configuration File Documentation<span style='color:windowtext;display:none;
text-decoration:none'>&nbsp; 5</span></a></span>.&nbsp; </p>

<h3><a name="_Toc140299174"></a><a name="_Toc140307952"></a>Connecting NXT to 
Microsoft Robotics Studio</h3>

<p><b>NOTE:</b> The procedure for connecting to the LEGO NXT has been simplified since the 
previous CTP.&nbsp; The Bluetooth connection must now be made <b>from</b> the PC <b>
to</b> the NXT brick using the bluetooth software installed on your PC.</p>
    <p>
        Consult your Bluetooth and LEGO documentation for further information on 
        establishing a bluetooth connection.&nbsp; During this process, you will 
        be prompted to select a pin on the NXT and enter the same pin on the PC.
    </p>
    <p>
        If successful, you may see something similar to this on the computer.&nbsp; 
        Take note of the COM port.</p>

<p align="center"><img border=0 width=382 height=119
src="readme_files/image008.jpg"></p>

<p>
    The next step is to start the LEGO® NXT Brick (LegoNxt) service.&nbsp; This 
    may be done in a variety of ways.&nbsp; The following instructions provide 
    one way to do this.</p>
    <p>
        Open a Microsoft Robotics Studio Command Prompt and start the LEGO NXT 
        manifest, then type the following:</p>
    <pre>dsshost -port:50000 -tcpport:50001 -manifest:&quot;samples\Config\LEGO.NXT.Brick.manifest.xml&quot;</pre>
<p>The console will display installation progress as the MSRS program is 
        sent to the NXT.&nbsp; If your service is started with an invalid COM 
        port, (0 for example), Internet Explorer will open up prompting you to 
        set the proper port.&nbsp; If your browser does not open up, you can 
        find the URL on the console window.&nbsp; It will be something like 
        this: <a
href="http://mymachine:50000/legonxt/0bcbf164-c568-43c5-a9e3-61d47a541a24">
        http://mycomputer:50000/legonxt/264ce902-c082-42f9-8626-0d52c3133d5c</a>, 
        except it will include your machine name and the GUID after /legonxt/ 
        will be different.&nbsp; You will see a screen like the one below.&nbsp; 
        You should configure your COM port and sensors, then press “Connect”.&nbsp; 
        This will cause a new config.txt file to be sent to the Lego NXT.&nbsp; 
        NOTE: This is also a good place to debug your NXT robot.&nbsp; It lets 
        you easily see all the sensor and motor values.</p>

<p align="center"><img src="readme_files/image007.png"></p>

<p>&nbsp;</p>

<p>When the “main” program is run, you will see this screen:</p>

<p align="center"><img border=0 src="readme_files/image011.jpg" alt="Lego NXT Screen showing Microsoft Robotics Studio with hourglass"></p>

<p>When at this screen, the NXT is waiting to receive either the 
configuration file or a start command from the PC.&nbsp; </p>
    <p>
        If your service is started with a valid com port, only a start message 
        will be sent to the NXT.&nbsp; The NXT should still have the 
        configuration file loaded on it.&nbsp; This is useful because sending 
        the configuration file to the NXT is error prone.&nbsp; However, if you 
        change your Bluetooth port or reconfigure your robot, you will have to 
        send an updated config.txt file to the robot.&nbsp; To do so, just start 
        your service, navigate to this page, change the settings, and press 
        “Connect”.</p>

<p>If all goes well the NXT will beep and the hourglass will 
disappear.&nbsp; Now your NXT brick will start sending messages according to the 
parameters in the configuration file. &nbsp;</p>

<p align="center"><img border=0 src="readme_files/image013.jpg" alt="Lego NXT screen showing Microsoft Robotics Studio without hourglass"></p>

<p>If something is improperly configured, such as if the “main” 
program is not running, or the Bluetooth link is setup in the wrong direction, 
you will see an error message on the console.&nbsp; You should follow the 
instructions on the screen.</p>

<h3><a name=trouble>Troubleshooting</a></h3>

<ul>
 <li>The service fails to connect to the NXT almost every time I 
 run it.
 <ul>
  <li>The part of the NXT initialization that is error prone is 
  when the configuration file is sent to the brick.&nbsp; This step can safely 
  be skipped if you are not changing the sensors around.&nbsp; To force the 
  LegoNxtService to not send the file, simply start the service with the proper 
  COM port.</li>
  <li>It has been found that the PC connects to the NXT more 
  reliably if you wait a few seconds to start your service after starting the 
  NXT and pairing with the computer. </li>
 </ul>
 </li>
 <li>I can send motor commands, but am not receiving sensor 
 messages.
 <ul>
  <li>It is possible that the configuration file on the NXT is 
  wrong.&nbsp; (All sensors are set to null for example).&nbsp; In this case, 
  you should force a new configuration file to be sent to the brick.&nbsp; See: <span class=MsoHyperlink><a href="#_Toc140307952">
  Connecting NXT to Microsoft Robotics Studio<span style='color:windowtext;display:none;
      text-decoration:none'>. 3</span></a></span>.</li>
 </ul>
 </li>
 <li>I cannot get the Bluetooth connection set up from the PC to 
 the NXT
 </li>
 <ul>
  <li>Try to disable then re-enable your Bluetooth antenna.</li>
  <li>Try restarting the PC.</li>
  <li>Try clearing your Bluetooth contacts on the NXT. </li>
  <li>If you are using a Bluetooth dongle, it is highly 
  recommended that you use the drivers that came on the CD with the dongle. 
  &nbsp;Note that if you try to switch drivers, you have to uninstall the previous 
  drivers first.&nbsp; This process will also require you to clear your 
  Bluetooth contacts in the NXT.</li>
 </ul>
 <li>I am seeing some other bad behavior.
 <ul>
  <li>Examine the output in Visual Studio. &nbsp;It is possible there 
  is an error in another service.</li>
  <li>Post your question to the <a
      href="http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.msroboticsstudio">
  Microsoft Robotics Studio newsgroup</a>.</li>
 </ul>
</li>
</ul>

<h3><a name="_Toc140299175"></a><a name="_Toc140307953"></a>Appendix – 
Configuration File Documentation&nbsp;</h3>

<p>Due to the simple read file 
operation of the NXT graphical language, the configuration file must have a very 
strict structure.&nbsp; The NXT can only read one entire line at a time as a 
numeric value.&nbsp; The structure of the file is as follows:</p>

<ul>
  <li>Sensor port 1 sensor type</li>
  <li>Sensor port 1 threshold 1</li>
  <li>Sensor port 1 threshold 2</li>
  <li>Sensor port 2 sensor type</li>
  <li>Sensor port 2 threshold 1</li>
  <li>Sensor port 2 threshold 2</li>
  <li>Sensor port 3 sensor type</li>
  <li>Sensor port 3 threshold 1</li>
  <li>Sensor port 3 threshold 2</li>
  <li>Sensor port 4 sensor type</li>
  <li>Sensor port 4 threshold 1</li>
  <li>Sensor port 4 threshold 2</li>
  <li>Motor port 1 sensor type</li>
  <li>Motor port 1 threshold 1</li>
  <li>Motor port 1 threshold 2</li>
  <li>Motor port 2 sensor type</li>
  <li>Motor port 2 threshold 1</li>
  <li>Motor port 2 threshold 2</li>
  <li>Motor port 3 sensor type</li>
  <li>Motor port 3 threshold 1</li>
  <li>Motor port 3 threshold 2</li>
  <li>Right button sensor type</li>
  <li>Left button sensor type</li>
  <li>Center button sensor type</li>
</ul>

<p>At the time of writing, the NXT 
graphical language did not support subroutines with text inputs.&nbsp; Therefore 
all sensor names are numeric.&nbsp; Here is a list of the available sensor 
types, their numeric names, ranges, and ports.</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=764
 style='width:572.85pt;border-collapse:collapse'>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;background:black;
  padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Number</span></b></p>
  </td>
  <td width=68 style='width:50.8pt;border:solid black 1.0pt;border-left:none;
  background:black;padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Name</span></b></p>
  </td>
  <td width=192 style='width:144.1pt;border:solid black 1.0pt;border-left:none;
  background:black;padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Description</span></b></p>
  </td>
  <td width=156 style='width:117.0pt;border:solid black 1.0pt;border-left:none;
  background:black;padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Available Range</span></b></p>
  </td>
  <td width=132 style='width:99.0pt;border:solid black 1.0pt;border-left:none;
  background:black;padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Available Ports</span></b></p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border:solid black 1.0pt;
  border-left:none;background:black;padding:0in 5.4pt 0in 5.4pt'>
  <p align=center><b><span
  style='color:white'>Syntax</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>0</p>
  </td>
  <td width=68 style='width:50.8pt;border-top:none;border-left:none;border-bottom:
  solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Null</p>
  </td>
  <td width=192 style='width:144.1pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor not connected</p>
  </td>
  <td width=156 style='width:117.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>N/A</p>
  </td>
  <td width=132 style='width:99.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>All</p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>0<br>
  0<br>
  0</p>
  </td>
 </tr>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>1</p>
  </td>
  <td width=68 style='width:50.8pt;border-top:none;border-left:none;border-bottom:
  solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Angle</p>
  </td>
  <td width=192 style='width:144.1pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Motor shaft angle</p>
  </td>
  <td width=156 style='width:117.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>-2147483647 to <br>
  +2147483647</p>
  </td>
  <td width=132 style='width:99.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Motor 1, 2, 3</p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>1<br>
  threshold 1</p>
  <p>threshold 2</p>
  </td>
 </tr>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>2</p>
  </td>
  <td width=68 style='width:50.8pt;border-top:none;border-left:none;border-bottom:
  solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Button</p>
  </td>
  <td width=192 style='width:144.1pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>NXT control buttons</p>
  </td>
  <td width=156 style='width:117.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-1</p>
  </td>
  <td width=132 style='width:99.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Right, Left, Enter Button</p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>2</p>
  </td>
 </tr>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>3</p>
  </td>
  <td width=68 style='width:50.8pt;border-top:none;border-left:none;border-bottom:
  solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Encoder</p>
  </td>
  <td width=192 style='width:144.1pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sampled down motor angle</p>
  </td>
  <td width=156 style='width:117.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>User specified. 2-360</p>
  </td>
  <td width=132 style='width:99.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Motor 1, 2, 3</p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>3<br>
  0</p>
  <p>Ticks per revolution</p>
  </td>
 </tr>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>4</p>
  </td>
  <td width=68 style='width:50.8pt;border-top:none;border-left:none;border-bottom:
  solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>LightOn</p>
  </td>
  <td width=192 style='width:144.1pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Light sensor with LED on</p>
  </td>
  <td width=156 style='width:117.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-100</p>
  </td>
  <td width=132 style='width:99.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>4<br>
  threshold 1</p>
  <p>threshold 2</p>
  </td>
 </tr>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>5</p>
  </td>
  <td width=68 style='width:50.8pt;border-top:none;border-left:none;border-bottom:
  solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sonar</p>
  </td>
  <td width=192 style='width:144.1pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Ultrasonic range sensor</p>
  </td>
  <td width=156 style='width:117.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-250</p>
  </td>
  <td width=132 style='width:99.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>5<br>
  threshold 1</p>
  <p>threshold 2</p>
  </td>
 </tr>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>6</p>
  </td>
  <td width=68 style='width:50.8pt;border-top:none;border-left:none;border-bottom:
  solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sound</p>
  </td>
  <td width=192 style='width:144.1pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sound sensor</p>
  </td>
  <td width=156 style='width:117.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-100</p>
  </td>
  <td width=132 style='width:99.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>6<br>
  threshold 1</p>
  <p>threshold 2</p>
  </td>
 </tr>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>7</p>
  </td>
  <td width=68 style='width:50.8pt;border-top:none;border-left:none;border-bottom:
  solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Touch</p>
  </td>
  <td width=192 style='width:144.1pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Binary touch sensor</p>
  </td>
  <td width=156 style='width:117.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-1</p>
  </td>
  <td width=132 style='width:99.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>7<br>
  0</p>
  <p>0</p>
  </td>
 </tr>
 <tr>
  <td width=71 style='width:53.5pt;border:solid black 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>8</p>
  </td>
  <td width=68 style='width:50.8pt;border-top:none;border-left:none;border-bottom:
  solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>LightOff</p>
  </td>
  <td width=192 style='width:144.1pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Light sensor with LED off</p>
  </td>
  <td width=156 style='width:117.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>0-100</p>
  </td>
  <td width=132 style='width:99.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p>Sensor 1, 2, 3, 4</p>
  </td>
  <td width=145 valign=top style='width:108.45pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p>4<br>
  threshold 1</p>
  <p>threshold 2</p>
  </td>
 </tr>
</table>

</div>

<p>NOTE: To specify an internal range, 
threshold 1 must be less than threshold 2.&nbsp; To specify an external range, 
threshold 1 should be greater than threshold 2.&nbsp; This is taken care of 
automatically in the <span style='font-size:10.0pt;font-family:"Courier New"'>
ParseConfig</span>
function before sending the file to the NXT.</p>

<p>For example, suppose you have:</p>

<ul>
 <li>a touch sensor on port 1</li>
 <li>a sonar sensor on port 2, and you want to be notified when 
 it reads less than 30 cm</li>
 <li>a light sensor on port 3, and you want to be notified when 
 it reads between 50 and 60</li>
 <li>nothing in sensor port 4</li>
 <li>you want to configure motor 1 to be an angle sensor and to 
 be notified when it is NOT in the range between 100 and 200 degrees</li>
 <li>you want to configure motors 2 and 3 to be encoders with 6 
 ticks per rev</li>
 <li>you only want to listen for the center NXT button</li>
</ul>

<p>The configuration file would be as follows:</p>

<pre>7
0
0
5
0
30
4
50
60
0
0
0
1
200
100
3
6
0
3
6
0
0
0
2</pre>
<p><b>Output:</b></p>

<p>When a sensor on the NXT is in the 
specified range AND its value has changed since the last iteration, then a 
message is sent back to the PC.&nbsp; The format of the message is as follows:</p>

<pre>&lt;Sensor Type&gt; &lt;Sensor Port&gt; &lt;Value&gt;</pre>

<p>This data is sent in decimal ASCII form.</p>

</body>

</html>